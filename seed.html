<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seeds | AgroMe</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="category.css">
</head>
<body>
    <div id="header-container">
        <div id="header"></div>
        <script>
            fetch('header.html')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('header').innerHTML = data;
                });
        </script>
    </div>

    <main class="main-content">
        <div class="content-container">
            <section class="category-section">
                <div class="category-header">
                    <img src="projectimages/seed.jpg" alt="Seeds" class="category-image">
                    <h1 class="category-title">Seeds</h1>
                </div>
                <div class="category-filter">
                    <h3>Filter By</h3>
                    <div class="filter-section">
                        <h4>Categories</h4>
                        <ul class="category-list">
                            <li><a href="fungicide.html"><i class="fas fa-seedling"></i> Fungicides</a></li>
                            <li><a href="insecticide.html"><i class="fas fa-bug"></i> Insecticides</a></li>
                            <li><a href="herbicide.html"><i class="fas fa-leaf"></i> Herbicides</a></li>
                            <li class="active"><a href="seed.html"><i class="fas fa-spa"></i> Seeds</a></li>
                            <li><a href="plantgrowth.html"><i class="fas fa-chart-line"></i> Plant Growth</a></li>
                            <li><a href="shopbybrand.html"><i class="fas fa-tags"></i> Shop By Brand</a></li>
                        </ul>
                    </div>
                    <div class="filter-section">
                        <h4>Price Range</h4>
                        <div class="price-range">
                            <input type="range" min="0" max="5000" value="5000" class="slider" id="priceRange">
                            <div class="price-values">
                                <span>₹0</span>
                                <span>₹5000</span>
                            </div>
                        </div>
                    </div>
                    <div class="filter-section">
                        <h4>Brand</h4>
                        <div class="brand-filter">
                            <label><input type="checkbox" checked> All Brands</label>
                            <label><input type="checkbox"> Kaveri Seeds</label>
                            <label><input type="checkbox"> Krishidhan</label>
                            <label><input type="checkbox"> Syngenta</label>
                            <label><input type="checkbox"> Paris Agrotech</label>
                        </div>
                    </div>
                </div>
            </section>

            <section class="product-display-section">
                <div class="product-sorting">
                    <span>Sort By:</span>
                    <select id="sortOptions">
                        <option value="featured">Featured</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="discount">Best Discount</option>
                        <option value="rating">Customer Rating</option>
                    </select>
                    <div class="product-count">Showing <span id="showingCount">0</span> of <span id="totalCount">0</span> products</div>
                </div>
                
                <div id="featured-products-container" class="product-container">
                    <!-- Seed Products will be dynamically inserted here -->
                </div>
                
                <div class="pagination">
                    <button class="pagination-btn" disabled><i class="fas fa-chevron-left"></i></button>
                    <span class="current-page">1</span>
                    <button class="pagination-btn"><i class="fas fa-chevron-right"></i></button>
                </div>
            </section>
        </div>
    </main>

    <div id="footer-container"></div>
    <script>
        fetch('footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer-container').innerHTML = data;
            });
    </script>

    <script type="module">
        import { products } from './data1/data.js';

        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('featured-products-container');
            const sortSelect = document.getElementById('sortOptions');
            const priceRange = document.getElementById('priceRange');
            const showingCount = document.getElementById('showingCount');
            const totalCount = document.getElementById('totalCount');
            
            let seedProducts = products.filter(product => product.category === "Seed");
            totalCount.textContent = seedProducts.length;
            
            function renderProducts(productsToRender) {
                container.innerHTML = '';
                showingCount.textContent = productsToRender.length;
                
                productsToRender.forEach(product => {
                    const discount = product.originalPrice * (product.discountPercentage / 100);
                    const finalPrice = product.originalPrice - discount;
                    const ratingStars = '★'.repeat(product.rating) + '☆'.repeat(5 - product.rating);

                    const productItem = document.createElement('div');
                    productItem.className = 'product-item';
                    productItem.innerHTML = `
                        <div class="product-image-container">
                            <img src="${product.imageSrc}" alt="${product.name}" loading="lazy">
                            ${product.discountPercentage > 0 ? 
                                `<div class="discount-badge">${product.discountPercentage}% OFF</div>` : ''}
                            <div class="quick-view-btn">Quick View</div>
                        </div>
                        <div class="product-details">
                            <h3>${product.name}</h3>
                            <p class="brand-name">${product.brandName}</p>
                            <div class="product-rating">
                                <span class="stars">${ratingStars}</span>
                                <span class="rating-count">(${product.ratingCount})</span>
                            </div>
                            <div class="price-container">
                                ${product.discountPercentage > 0 ? 
                                    `<span class="original-price">₹${product.originalPrice.toFixed(2)}</span>` : ''}
                                <span class="discounted-price">₹${finalPrice.toFixed(2)}</span>
                            </div>
                        </div>
                    `;

                    productItem.addEventListener('click', (e) => {
                        if (!e.target.classList.contains('quick-view-btn')) {
                            window.location.href = `product.html?id=${product.id}`;
                        }
                    });

                    const quickViewBtn = productItem.querySelector('.quick-view-btn');
                    quickViewBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        showQuickView(product);
                    });

                    container.appendChild(productItem);
                });
            }

            renderProducts(seedProducts);

            sortSelect.addEventListener('change', () => {
                const sortValue = sortSelect.value;
                let sortedProducts = [...seedProducts];
                
                switch(sortValue) {
                    case 'price-low':
                        sortedProducts.sort((a, b) => (a.originalPrice - (a.originalPrice * a.discountPercentage / 100)) - 
                                                      (b.originalPrice - (b.originalPrice * b.discountPercentage / 100)));
                        break;
                    case 'price-high':
                        sortedProducts.sort((a, b) => (b.originalPrice - (b.originalPrice * b.discountPercentage / 100)) - 
                                                      (a.originalPrice - (a.originalPrice * a.discountPercentage / 100)));
                        break;
                    case 'discount':
                        sortedProducts.sort((a, b) => b.discountPercentage - a.discountPercentage);
                        break;
                    case 'rating':
                        sortedProducts.sort((a, b) => b.rating - a.rating);
                        break;
                }
                
                renderProducts(sortedProducts);
            });

            priceRange.addEventListener('input', () => {
                const maxPrice = parseInt(priceRange.value);
                const filteredProducts = seedProducts.filter(product => {
                    const finalPrice = product.originalPrice - (product.originalPrice * product.discountPercentage / 100);
                    return finalPrice <= maxPrice;
                });
                renderProducts(filteredProducts);
            });

            function showQuickView(product) {
                const discount = product.originalPrice * (product.discountPercentage / 100);
                const finalPrice = product.originalPrice - discount;
                const ratingStars = '★'.repeat(product.rating) + '☆'.repeat(5 - product.rating);
                
                const modal = document.createElement('div');
                modal.className = 'quick-view-modal';
                modal.innerHTML = `
                    <div class="modal-content">
                        <span class="close-modal">&times;</span>
                        <div class="modal-product">
                            <div class="modal-image">
                                <img src="${product.imageSrc}" alt="${product.name}">
                            </div>
                            <div class="modal-details">
                                <h2>${product.name}</h2>
                                <p class="brand">Brand: ${product.brandName}</p>
                                <div class="rating">
                                    ${ratingStars} <span>(${product.ratingCount} reviews)</span>
                                </div>
                                <div class="price">
                                    <span class="current">₹${finalPrice.toFixed(2)}</span>
                                    ${product.discountPercentage > 0 ? 
                                        `<span class="original">₹${product.originalPrice.toFixed(2)}</span>
                                         <span class="discount">${product.discountPercentage}% OFF</span>` : ''}
                                </div>
                                <div class="description">
                                    <h3>Description</h3>
                                    <p>${product.description || 'No description available.'}</p>
                                </div>
                                <div class="actions">
                                    <button class="buy-now">Buy Now</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                const closeBtn = modal.querySelector('.close-modal');
                closeBtn.addEventListener('click', () => {
                    document.body.removeChild(modal);
                });

                const buyNow = modal.querySelector('.buy-now');
                buyNow.addEventListener('click', () => {
                    alert(`Buy now: ${product.name}`);
                });
            }
        });
    </script>
</body>
</html>